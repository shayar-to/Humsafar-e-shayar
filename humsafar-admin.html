<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Admin · Humsafar-e-Shayar</title>
<link href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,500;1,400;1,500&family=Cinzel:wght@400;500&family=Noto+Nastaliq+Urdu:wght@400;500&display=swap" rel="stylesheet"/>
<style>
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
:root{
  --ink:#0a0608;--deep:#110d0f;--mid:#1e1418;--surface:#16120e;
  --rose:#8b2a3c;--rose2:#c4485e;
  --gold:#d4a853;--gold2:#f0cc7a;
  --cream:#f5ede0;--fog:#c8b8a8;--dim:#7a6a5a;
  --green:#3d7a5c;--green2:#5ab889;
  --red:#7a2a2a;--red2:#c45858;
}
html{scroll-behavior:smooth}
body{background:var(--ink);color:var(--cream);font-family:'EB Garamond',serif;font-size:16px;min-height:100vh}

/* ── LOGIN ── */
#loginScreen{
  position:fixed;inset:0;z-index:1000;
  background:var(--ink);
  display:flex;align-items:center;justify-content:center;
  flex-direction:column;gap:1.5rem;
  transition:opacity .8s,visibility .8s;
}
#loginScreen.gone{opacity:0;visibility:hidden;pointer-events:none}
.login-box{
  background:var(--surface);
  border:1px solid rgba(212,168,83,.15);
  padding:3.5rem 3rem;
  width:100%;max-width:420px;
  text-align:center;
}
.login-logo{font-family:'Cinzel',serif;font-size:1.2rem;letter-spacing:.1em;color:var(--gold2);margin-bottom:.4rem}
.login-sub{font-size:.72rem;letter-spacing:.2em;text-transform:uppercase;color:var(--dim);margin-bottom:2.5rem}
.login-label{display:block;text-align:left;font-size:.68rem;letter-spacing:.18em;text-transform:uppercase;color:var(--dim);margin-bottom:.5rem}
.login-input{
  width:100%;padding:.8rem 1rem;
  background:rgba(255,255,255,.04);
  border:1px solid rgba(212,168,83,.15);
  color:var(--cream);font-family:'EB Garamond',serif;font-size:1rem;
  outline:none;transition:border-color .3s;
  margin-bottom:1.2rem;
}
.login-input:focus{border-color:rgba(212,168,83,.5)}
.login-btn{
  width:100%;padding:.85rem;
  background:transparent;border:1px solid var(--gold);
  color:var(--gold2);font-family:'Cinzel',serif;
  font-size:.75rem;letter-spacing:.22em;text-transform:uppercase;
  cursor:pointer;transition:all .4s;position:relative;overflow:hidden;
}
.login-btn::before{content:'';position:absolute;inset:0;background:linear-gradient(135deg,var(--rose),var(--gold));transform:translateX(-101%);transition:transform .4s cubic-bezier(.16,1,.3,1);z-index:-1}
.login-btn:hover::before{transform:translateX(0)}
.login-btn:hover{color:var(--ink)}
.login-error{color:var(--red2);font-size:.8rem;font-style:italic;min-height:1.2em}
.login-hint{font-size:.72rem;color:var(--dim);font-style:italic;margin-top:1.5rem}

/* ── LAYOUT ── */
#app{display:none;min-height:100vh}
#app.ready{display:flex}

.sidebar{
  width:260px;flex-shrink:0;
  background:var(--surface);
  border-right:1px solid rgba(212,168,83,.1);
  display:flex;flex-direction:column;
  position:sticky;top:0;height:100vh;overflow-y:auto;
}
.sidebar-header{
  padding:2rem 1.5rem 1.5rem;
  border-bottom:1px solid rgba(212,168,83,.1);
}
.sidebar-logo{font-family:'Cinzel',serif;font-size:.95rem;letter-spacing:.1em;color:var(--gold2)}
.sidebar-role{font-size:.65rem;letter-spacing:.2em;text-transform:uppercase;color:var(--dim);margin-top:.2rem}
.sidebar-nav{padding:1rem 0;flex:1}
.snav-item{
  display:flex;align-items:center;gap:.8rem;
  padding:.75rem 1.5rem;
  color:var(--dim);font-size:.82rem;letter-spacing:.08em;
  cursor:pointer;transition:all .3s;
  border-left:3px solid transparent;
  user-select:none;
}
.snav-item:hover{color:var(--cream);background:rgba(212,168,83,.04)}
.snav-item.active{color:var(--gold2);background:rgba(212,168,83,.07);border-left-color:var(--gold)}
.snav-icon{font-size:1rem;width:20px;text-align:center}
.snav-badge{margin-left:auto;background:var(--rose);color:white;font-size:.6rem;padding:.15rem .4rem;border-radius:2px}
.sidebar-footer{padding:1.5rem;border-top:1px solid rgba(212,168,83,.1)}
.logout-btn{
  width:100%;padding:.6rem;background:none;border:1px solid rgba(212,168,83,.15);
  color:var(--dim);font-family:'EB Garamond',serif;font-size:.75rem;
  letter-spacing:.12em;text-transform:uppercase;cursor:pointer;
  transition:all .3s;
}
.logout-btn:hover{border-color:var(--red2);color:var(--red2)}
.view-site-btn{
  display:block;width:100%;padding:.6rem;background:rgba(212,168,83,.08);
  border:1px solid rgba(212,168,83,.2);color:var(--gold);
  font-family:'EB Garamond',serif;font-size:.75rem;
  letter-spacing:.12em;text-transform:uppercase;
  cursor:pointer;transition:all .3s;text-align:center;
  text-decoration:none;margin-bottom:.7rem;
}
.view-site-btn:hover{background:rgba(212,168,83,.15)}

/* ── MAIN ── */
.main{flex:1;overflow-y:auto;padding:2.5rem 3rem;max-width:1000px}
.page{display:none}
.page.active{display:block}

.page-title{font-family:'Cinzel',serif;font-size:1.4rem;letter-spacing:.08em;color:var(--cream);margin-bottom:.4rem}
.page-sub{font-style:italic;color:var(--dim);font-size:.88rem;margin-bottom:2.5rem}

/* ── STATS ── */
.stats-row{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:1rem;margin-bottom:2.5rem}
.stat-card{background:var(--surface);border:1px solid rgba(212,168,83,.1);padding:1.5rem;text-align:center}
.stat-num{font-family:'Cinzel',serif;font-size:2.5rem;color:var(--gold2);line-height:1}
.stat-label{font-size:.68rem;letter-spacing:.18em;text-transform:uppercase;color:var(--dim);margin-top:.4rem}

/* ── FORM ── */
.form-section{background:var(--surface);border:1px solid rgba(212,168,83,.1);padding:2rem;margin-bottom:2rem}
.form-title{font-family:'Cinzel',serif;font-size:.88rem;letter-spacing:.12em;color:var(--gold);margin-bottom:1.5rem;padding-bottom:.75rem;border-bottom:1px solid rgba(212,168,83,.1)}
.form-grid{display:grid;grid-template-columns:1fr 1fr;gap:1.2rem}
.form-grid.full{grid-template-columns:1fr}
.field{display:flex;flex-direction:column;gap:.5rem}
.field label{font-size:.65rem;letter-spacing:.18em;text-transform:uppercase;color:var(--dim)}
.field input,.field textarea,.field select{
  background:rgba(255,255,255,.04);
  border:1px solid rgba(212,168,83,.15);
  color:var(--cream);
  font-family:'EB Garamond',serif;font-size:1rem;
  padding:.7rem .9rem;outline:none;
  transition:border-color .3s;
  resize:vertical;
}
.field input:focus,.field textarea:focus,.field select:focus{border-color:rgba(212,168,83,.5)}
.field textarea{min-height:90px;line-height:1.7}
.field textarea.urdu-input{font-family:'Noto Nastaliq Urdu',serif;direction:rtl;font-size:1.1rem;line-height:2;min-height:100px}
.field select option{background:var(--deep)}
.char-count{font-size:.65rem;color:var(--dim);text-align:right;margin-top:.2rem}

.form-actions{display:flex;gap:1rem;margin-top:1.5rem;flex-wrap:wrap}
.btn{
  padding:.7rem 2rem;font-family:'Cinzel',serif;
  font-size:.7rem;letter-spacing:.18em;text-transform:uppercase;
  cursor:pointer;border:none;transition:all .3s;position:relative;overflow:hidden;
}
.btn-primary{background:linear-gradient(135deg,var(--rose),var(--gold));color:var(--ink)}
.btn-primary:hover{opacity:.85;transform:translateY(-1px)}
.btn-secondary{background:none;border:1px solid rgba(212,168,83,.25);color:var(--gold)}
.btn-secondary:hover{border-color:var(--gold);background:rgba(212,168,83,.06)}
.btn-danger{background:none;border:1px solid rgba(196,88,88,.3);color:var(--red2)}
.btn-danger:hover{border-color:var(--red2);background:rgba(196,88,88,.06)}
.btn-sm{padding:.45rem 1.2rem;font-size:.62rem}

/* ── SHAYARI LIST ── */
.list-toolbar{display:flex;align-items:center;gap:1rem;margin-bottom:1.5rem;flex-wrap:wrap}
.search-input{
  flex:1;min-width:180px;
  background:rgba(255,255,255,.04);
  border:1px solid rgba(212,168,83,.15);
  color:var(--cream);font-family:'EB Garamond',serif;
  font-size:.9rem;padding:.6rem 1rem;outline:none;
  transition:border-color .3s;
}
.search-input:focus{border-color:rgba(212,168,83,.4)}
.search-input::placeholder{color:var(--dim)}

.slist{display:flex;flex-direction:column;gap:1rem}
.slist-item{
  background:var(--surface);
  border:1px solid rgba(212,168,83,.1);
  padding:1.5rem;
  display:grid;grid-template-columns:1fr auto;
  gap:1rem;align-items:start;
  transition:border-color .3s;
}
.slist-item:hover{border-color:rgba(212,168,83,.22)}
.slist-tag{font-size:.62rem;letter-spacing:.2em;text-transform:uppercase;color:var(--rose2);margin-bottom:.5rem}
.slist-urdu{font-family:'Noto Nastaliq Urdu',serif;direction:rtl;font-size:1rem;line-height:2;color:var(--cream);margin-bottom:.4rem}
.slist-en{font-style:italic;font-size:.88rem;color:var(--fog);line-height:1.6;margin-bottom:.6rem}
.slist-meta{font-size:.68rem;color:var(--dim);letter-spacing:.08em}
.slist-meta span{color:var(--gold2)}
.slist-actions{display:flex;flex-direction:column;gap:.5rem;min-width:80px}

/* ── TOAST ── */
#toast{
  position:fixed;bottom:2rem;right:2rem;z-index:500;
  display:flex;flex-direction:column;gap:.5rem;
}
.toast-msg{
  background:var(--surface);border-left:3px solid var(--gold);
  padding:.9rem 1.4rem;font-size:.82rem;color:var(--cream);
  min-width:250px;
  animation:toastIn .4s cubic-bezier(.16,1,.3,1) forwards;
  box-shadow:0 8px 30px rgba(0,0,0,.4);
}
.toast-msg.success{border-left-color:var(--green2)}
.toast-msg.error{border-left-color:var(--red2)}
@keyframes toastIn{from{opacity:0;transform:translateX(30px)}to{opacity:1;transform:none}}

/* ── PREVIEW ── */
.preview-card{
  background:linear-gradient(135deg,rgba(30,20,24,.9),rgba(17,13,15,.95));
  border:1px solid rgba(212,168,83,.15);
  padding:2.2rem 1.8rem;max-width:380px;
  position:relative;
}
.preview-card::after{content:'';position:absolute;left:0;top:0;bottom:0;width:3px;background:linear-gradient(to bottom,var(--rose),var(--gold))}
.preview-empty{color:var(--dim);font-style:italic;font-size:.9rem;padding:2rem;text-align:center}

/* ── SETTINGS ── */
.settings-group{background:var(--surface);border:1px solid rgba(212,168,83,.1);padding:2rem;margin-bottom:1.5rem}
.settings-group h3{font-family:'Cinzel',serif;font-size:.82rem;letter-spacing:.15em;color:var(--gold);margin-bottom:1.5rem}
.setting-row{display:flex;align-items:center;justify-content:space-between;padding:.8rem 0;border-bottom:1px solid rgba(212,168,83,.06)}
.setting-row:last-child{border-bottom:none}
.setting-info{flex:1}
.setting-info strong{display:block;font-size:.88rem;color:var(--cream);font-weight:400;margin-bottom:.2rem}
.setting-info small{font-size:.75rem;color:var(--dim);font-style:italic}
.toggle{position:relative;width:40px;height:22px;flex-shrink:0}
.toggle input{opacity:0;width:0;height:0;position:absolute}
.toggle-track{position:absolute;inset:0;background:rgba(255,255,255,.1);border:1px solid rgba(212,168,83,.2);border-radius:11px;cursor:pointer;transition:.3s}
.toggle input:checked+.toggle-track{background:linear-gradient(135deg,var(--rose),var(--gold));border-color:transparent}
.toggle-track::after{content:'';position:absolute;left:3px;top:50%;transform:translateY(-50%);width:14px;height:14px;background:var(--cream);border-radius:50%;transition:.3s}
.toggle input:checked+.toggle-track::after{transform:translateY(-50%) translateX(18px)}

/* ── SCROLLBAR ── */
::-webkit-scrollbar{width:4px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:rgba(212,168,83,.2);border-radius:2px}

/* ── DIVIDER ── */
.hr{height:1px;background:linear-gradient(to right,transparent,rgba(212,168,83,.15),transparent);margin:2rem 0}

@media(max-width:768px){
  .sidebar{width:220px}
  .main{padding:1.5rem}
  .form-grid{grid-template-columns:1fr}
  .stats-row{grid-template-columns:1fr 1fr}
}
@media(max-width:600px){
  #app{flex-direction:column}
  .sidebar{width:100%;height:auto;position:relative}
  .sidebar-nav{display:flex;overflow-x:auto;padding:.5rem 0}
  .snav-item{flex-direction:column;gap:.2rem;padding:.6rem 1rem;font-size:.7rem;border-left:none;border-bottom:2px solid transparent}
  .snav-item.active{border-bottom-color:var(--gold);border-left:none}
}
</style>
</head>
<body>

<!-- LOGIN -->
<div id="loginScreen">
  <div class="login-box">
    <p class="login-logo">Humsafar-e-Shayar</p>
    <p class="login-sub">Admin Portal</p>
    <label class="login-label">Password</label>
    <input type="password" class="login-input" id="pwdInput" placeholder="Enter your password" onkeydown="if(event.key==='Enter')doLogin()"/>
    <button class="login-btn" onclick="doLogin()">Enter the Portal</button>
    <p class="login-error" id="loginError"></p>
    <p class="login-hint">Default password: <strong>shayar123</strong><br>Change it in Settings after login.</p>
  </div>
</div>

<!-- APP -->
<div id="app">
  <!-- SIDEBAR -->
  <div class="sidebar">
    <div class="sidebar-header">
      <div class="sidebar-logo">Humsafar-e-Shayar</div>
      <div class="sidebar-role">Admin Panel</div>
    </div>
    <div class="sidebar-nav">
      <div class="snav-item active" onclick="showPage('dashboard')"><span class="snav-icon">◈</span> Dashboard</div>
      <div class="snav-item" onclick="showPage('add')"><span class="snav-icon">✦</span> Add Shayari</div>
      <div class="snav-item" onclick="showPage('manage')"><span class="snav-icon">≡</span> Manage Verses <span class="snav-badge" id="countBadge">0</span></div>
      <div class="snav-item" onclick="showPage('settings')"><span class="snav-icon">⚙</span> Settings</div>
    </div>
    <div class="sidebar-footer">
      <a href="humsafar-e-shayar.html" class="view-site-btn" target="_blank">↗ View Live Site</a>
      <button class="logout-btn" onclick="doLogout()">Sign Out</button>
    </div>
  </div>

  <!-- MAIN -->
  <div class="main">

    <!-- DASHBOARD -->
    <div class="page active" id="page-dashboard">
      <p class="page-title">Dashboard</p>
      <p class="page-sub">Your shayari collection at a glance</p>
      <div class="stats-row">
        <div class="stat-card"><div class="stat-num" id="stat-total">0</div><div class="stat-label">Total Verses</div></div>
        <div class="stat-card"><div class="stat-num" id="stat-genres">0</div><div class="stat-label">Genres</div></div>
        <div class="stat-card"><div class="stat-num" id="stat-authors">0</div><div class="stat-label">Poets</div></div>
        <div class="stat-card"><div class="stat-num" id="stat-recent">—</div><div class="stat-label">Latest Added</div></div>
      </div>

      <div class="form-section">
        <div class="form-title">Recent Verses</div>
        <div id="recentList"></div>
      </div>

      <div class="form-section">
        <div class="form-title">Quick Add</div>
        <p style="font-style:italic;color:var(--dim);font-size:.88rem;margin-bottom:1rem">Quickly drop in a new verse — for full options use the <strong style="color:var(--gold)">Add Shayari</strong> page.</p>
        <div class="form-grid">
          <div class="field"><label>Urdu / Hindi Verse *</label><textarea class="urdu-input" id="q-urdu" placeholder="اپنا شعر یہاں لکھیں..."></textarea></div>
          <div class="field"><label>English Translation</label><textarea id="q-en" placeholder="English meaning (optional)..."></textarea></div>
        </div>
        <div class="form-grid" style="margin-top:1rem">
          <div class="field"><label>Genre / Tag</label>
            <select id="q-tag"><option value="Ishq · Love">Ishq · Love</option><option value="Dard · Grief">Dard · Grief</option><option value="Judaai · Separation">Judaai · Separation</option><option value="Zindagi · Life">Zindagi · Life</option><option value="Umeed · Hope">Umeed · Hope</option><option value="Sufi · Soul">Sufi · Soul</option><option value="Watan · Homeland">Watan · Homeland</option><option value="Ghazal">Ghazal</option><option value="Nazm">Nazm</option><option value="Raat · Night">Raat · Night</option><option value="Custom">Custom...</option></select>
          </div>
          <div class="field"><label>Poet / Author</label><input type="text" id="q-author" placeholder="Your name or poet's name"/></div>
        </div>
        <div class="form-actions"><button class="btn btn-primary" onclick="quickAdd()">✦ Publish Verse</button></div>
      </div>
    </div>

    <!-- ADD SHAYARI -->
    <div class="page" id="page-add">
      <p class="page-title">Add New Shayari</p>
      <p class="page-sub">Craft your verse and publish it to the world</p>

      <div style="display:grid;grid-template-columns:1fr 380px;gap:1.5rem;align-items:start" id="addLayout">
        <div>
          <div class="form-section">
            <div class="form-title">The Verse</div>
            <div class="field" style="margin-bottom:1.2rem">
              <label>Urdu / Hindi Text *</label>
              <textarea class="urdu-input" id="a-urdu" placeholder="اپنا شعر یہاں لکھیں..." oninput="updatePreview()"></textarea>
            </div>
            <div class="field">
              <label>English Translation / Meaning</label>
              <textarea id="a-en" placeholder="English translation or meaning (optional)..." oninput="updatePreview()"></textarea>
            </div>
          </div>
          <div class="form-section">
            <div class="form-title">Details</div>
            <div class="form-grid">
              <div class="field">
                <label>Genre / Mood Tag *</label>
                <select id="a-tag" onchange="handleTagChange()">
                  <option value="Ishq · Love">Ishq · Love</option>
                  <option value="Dard · Grief">Dard · Grief</option>
                  <option value="Judaai · Separation">Judaai · Separation</option>
                  <option value="Zindagi · Life">Zindagi · Life</option>
                  <option value="Umeed · Hope">Umeed · Hope</option>
                  <option value="Sufi · Soul">Sufi · Soul</option>
                  <option value="Watan · Homeland">Watan · Homeland</option>
                  <option value="Ghazal">Ghazal</option>
                  <option value="Nazm">Nazm</option>
                  <option value="Raat · Night">Raat · Night</option>
                  <option value="custom">+ Add Custom Tag</option>
                </select>
              </div>
              <div class="field" id="customTagField" style="display:none">
                <label>Custom Tag Name</label>
                <input type="text" id="a-custom-tag" placeholder="e.g. Khushi · Joy" oninput="updatePreview()"/>
              </div>
              <div class="field">
                <label>Poet / Author</label>
                <input type="text" id="a-author" placeholder="Your name or poet's name" oninput="updatePreview()"/>
              </div>
            </div>
          </div>
          <div class="form-actions">
            <button class="btn btn-primary" onclick="addShayari()">✦ Publish to Site</button>
            <button class="btn btn-secondary" onclick="clearAddForm()">Clear</button>
          </div>
        </div>

        <!-- Live Preview -->
        <div>
          <div style="font-size:.65rem;letter-spacing:.2em;text-transform:uppercase;color:var(--dim);margin-bottom:.8rem">Live Preview</div>
          <div id="livePreview">
            <div class="preview-card">
              <div class="preview-empty">Start typing to see your verse preview...</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- MANAGE -->
    <div class="page" id="page-manage">
      <p class="page-title">Manage Verses</p>
      <p class="page-sub">Edit or remove published shayari</p>
      <div class="list-toolbar">
        <input type="text" class="search-input" id="searchInput" placeholder="Search verses, tags, authors..." oninput="renderManageList()"/>
        <select id="filterTag" onchange="renderManageList()" style="background:rgba(255,255,255,.04);border:1px solid rgba(212,168,83,.15);color:var(--fog);font-family:'EB Garamond',serif;font-size:.88rem;padding:.6rem .9rem;outline:none">
          <option value="">All Genres</option>
        </select>
        <button class="btn btn-secondary btn-sm" onclick="exportShayari()">↓ Export JSON</button>
      </div>
      <div class="slist" id="manageList"></div>
    </div>

    <!-- SETTINGS -->
    <div class="page" id="page-settings">
      <p class="page-title">Settings</p>
      <p class="page-sub">Manage your site preferences</p>

      <div class="settings-group">
        <h3>Security</h3>
        <div class="setting-row">
          <div class="setting-info">
            <strong>Change Admin Password</strong>
            <small>Update your portal login password</small>
          </div>
        </div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem;margin-top:1rem">
          <div class="field"><label>New Password</label><input type="password" id="newPwd" placeholder="New password"/></div>
          <div class="field"><label>Confirm Password</label><input type="password" id="confirmPwd" placeholder="Confirm password"/></div>
        </div>
        <div class="form-actions" style="margin-top:1rem"><button class="btn btn-primary btn-sm" onclick="changePassword()">Update Password</button></div>
      </div>

      <div class="settings-group">
        <h3>Site Content</h3>
        <div class="setting-row">
          <div class="setting-info">
            <strong>Show Default Sample Verses</strong>
            <small>Display the built-in Ghalib / Faiz verses when no custom ones exist</small>
          </div>
          <label class="toggle"><input type="checkbox" id="showDefaults" checked onchange="saveSiteSettings()"/><div class="toggle-track"></div></label>
        </div>
        <div class="setting-row">
          <div class="setting-info">
            <strong>Show Splash Screen</strong>
            <small>The animated intro screen on site load</small>
          </div>
          <label class="toggle"><input type="checkbox" id="showSplash" checked onchange="saveSiteSettings()"/><div class="toggle-track"></div></label>
        </div>
      </div>

      <div class="settings-group">
        <h3>Data Management</h3>
        <div class="setting-row">
          <div class="setting-info">
            <strong>Import Shayari from JSON</strong>
            <small>Upload a previously exported collection</small>
          </div>
          <div><input type="file" id="importFile" accept=".json" style="display:none" onchange="importShayari(event)"/><button class="btn btn-secondary btn-sm" onclick="document.getElementById('importFile').click()">Import</button></div>
        </div>
        <div class="setting-row">
          <div class="setting-info">
            <strong>Reset to Default Verses</strong>
            <small>Restore the original sample shayari collection</small>
          </div>
          <button class="btn btn-danger btn-sm" onclick="resetToDefaults()">Reset</button>
        </div>
        <div class="setting-row">
          <div class="setting-info">
            <strong>Delete All Verses</strong>
            <small>Permanently remove all shayari from the site</small>
          </div>
          <button class="btn btn-danger btn-sm" onclick="deleteAll()">Delete All</button>
        </div>
      </div>

      <div class="settings-group">
        <h3>About</h3>
        <div class="setting-row">
          <div class="setting-info">
            <strong>Humsafar-e-Shayar Admin</strong>
            <small>Version 1.0 · Built with love for poetry</small>
          </div>
        </div>
      </div>
    </div>

  </div><!-- /main -->
</div><!-- /app -->

<div id="toast"></div>

<!-- EDIT MODAL -->
<div id="editModal" style="display:none;position:fixed;inset:0;z-index:300;background:rgba(0,0,0,.7);align-items:center;justify-content:center;padding:2rem">
  <div style="background:var(--deep);border:1px solid rgba(212,168,83,.2);padding:2.5rem;width:100%;max-width:600px;max-height:90vh;overflow-y:auto">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem">
      <p style="font-family:'Cinzel',serif;letter-spacing:.1em;color:var(--gold)">Edit Verse</p>
      <button onclick="closeEdit()" style="background:none;border:none;color:var(--dim);font-size:1.2rem;cursor:pointer">✕</button>
    </div>
    <div class="field" style="margin-bottom:1rem"><label>Urdu / Hindi Text</label><textarea class="urdu-input" id="e-urdu"></textarea></div>
    <div class="field" style="margin-bottom:1rem"><label>English Translation</label><textarea id="e-en"></textarea></div>
    <div class="form-grid" style="margin-bottom:1.5rem">
      <div class="field"><label>Tag / Genre</label>
        <select id="e-tag">
          <option>Ishq · Love</option><option>Dard · Grief</option><option>Judaai · Separation</option><option>Zindagi · Life</option><option>Umeed · Hope</option><option>Sufi · Soul</option><option>Watan · Homeland</option><option>Ghazal</option><option>Nazm</option><option>Raat · Night</option>
        </select>
      </div>
      <div class="field"><label>Author</label><input type="text" id="e-author"/></div>
    </div>
    <div class="form-actions"><button class="btn btn-primary" onclick="saveEdit()">Save Changes</button><button class="btn btn-secondary" onclick="closeEdit()">Cancel</button></div>
  </div>
</div>

<script>
// ── DEFAULT DATA ──
const DEFAULT_SHAYARI=[
  {id:'d1',tag:'Ishq · Love',urdu:'تم سے ملنے کی خواہش میں جی رہا ہوں\nتمہیں بھول جانے کی کوشش میں جی رہا ہوں',en:'In the longing to meet you, I live on,\nIn the effort to forget you, I carry on.',author:'Mirza Ghalib',date:'2025-01-01'},
  {id:'d2',tag:'Dard · Grief',urdu:'دل ڈھونڈتا ہے پھر وہی فرصت کے رات دن\nبیٹھے رہیں تصور جاناں کیے ہوئے',en:'My heart seeks again those leisured nights and days,\nTo sit and lose itself in her remembered gaze.',author:'Mirza Ghalib',date:'2025-01-02'},
  {id:'d3',tag:'Judaai · Separation',urdu:'تیرے جانے کے بعد اتنا سکوت ہے گھر میں\nجیسے کوئی خواب تھا جو ٹوٹ گیا ہو',en:'After you left, such silence fills this home —\nas if a dream had shattered, leaving me alone.',author:'Faiz Ahmed Faiz',date:'2025-01-03'},
  {id:'d4',tag:'Zindagi · Life',urdu:'ہزاروں خواہشیں ایسی کہ ہر خواہش پہ دم نکلے\nبہت نکلے مرے ارمان لیکن پھر بھی کم نکلے',en:'A thousand desires — each one worth dying for.\nMany were fulfilled, yet longing asked for more.',author:'Mirza Ghalib',date:'2025-01-04'},
  {id:'d5',tag:'Sufi · Soul',urdu:'ہر ذرے میں تیری جھلک نظر آتی ہے\nیہ کائنات تیری محبت کا آئینہ ہے',en:'In every particle, your reflection appears —\nthis universe is a mirror of your love.',author:'Rumi (tr.)',date:'2025-01-05'},
  {id:'d6',tag:'Ghazal',urdu:'آہ کو چاہیے اک عمر اثر ہونے تک\nکون جیتا ہے تری زلف کے سر ہونے تک',en:'A sigh needs a lifetime to take effect —\nwho lives long enough to see your veil swept back?',author:'Mirza Ghalib',date:'2025-01-06'},
];

// ── STORAGE HELPERS (localStorage + in-memory fallback) ──
let _memShayari=null,_memPwd=null;
function loadData(){
  try{const r=localStorage.getItem('hs_shayari');if(r)return JSON.parse(r)}catch(e){}
  if(_memShayari)return _memShayari;
  const d=JSON.parse(JSON.stringify(DEFAULT_SHAYARI));
  saveData(d);return d;
}
function saveData(d){
  _memShayari=d;
  try{localStorage.setItem('hs_shayari',JSON.stringify(d))}catch(e){}
}
function loadPwd(){
  try{return localStorage.getItem('hs_admin_pwd')||'shayar123'}catch(e){}
  return _memPwd||'shayar123';
}
function savePwd(p){
  _memPwd=p;
  try{localStorage.setItem('hs_admin_pwd',p)}catch(e){}
}

let shayari=[];
let editId=null;

// ── LOGIN ──
function doLogin(){
  const pwd=document.getElementById('pwdInput').value;
  const correct=loadPwd();
  if(pwd===correct){
    document.getElementById('loginScreen').classList.add('gone');
    document.getElementById('app').classList.add('ready');
    shayari=loadData();
    refreshAll();
  } else {
    document.getElementById('loginError').textContent='Incorrect password. Try again.';
    document.getElementById('pwdInput').value='';
    setTimeout(()=>document.getElementById('loginError').textContent='',3000);
  }
}
function doLogout(){document.getElementById('app').classList.remove('ready');document.getElementById('loginScreen').classList.remove('gone');document.getElementById('pwdInput').value=''}

// ── NAVIGATION ──
function showPage(id){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('.snav-item').forEach(n=>n.classList.remove('active'));
  document.getElementById('page-'+id).classList.add('active');
  const items=document.querySelectorAll('.snav-item');
  const map={dashboard:0,add:1,manage:2,settings:3};
  if(map[id]!==undefined)items[map[id]].classList.add('active');
  if(id==='manage')renderManageList();
  if(id==='dashboard')renderDashboard();
}

// ── REFRESH ALL ──
function refreshAll(){renderDashboard();renderManageList();updateBadge()}
function updateBadge(){document.getElementById('countBadge').textContent=shayari.length}

// ── DASHBOARD ──
function renderDashboard(){
  document.getElementById('stat-total').textContent=shayari.length;
  document.getElementById('stat-genres').textContent=new Set(shayari.map(s=>s.tag)).size;
  document.getElementById('stat-authors').textContent=new Set(shayari.map(s=>s.author).filter(Boolean)).size||'—';
  const recent=shayari.length?shayari[shayari.length-1]:null;
  document.getElementById('stat-recent').textContent=recent?new Date(recent.date).toLocaleDateString('en-IN',{day:'numeric',month:'short'}):'—';
  const list=document.getElementById('recentList');
  const latest=[...shayari].reverse().slice(0,3);
  if(!latest.length){list.innerHTML='<p style="color:var(--dim);font-style:italic;font-size:.88rem">No verses yet. Add your first shayari!</p>';return}
  list.innerHTML=latest.map(s=>`
    <div style="padding:.9rem 0;border-bottom:1px solid rgba(212,168,83,.06);display:flex;justify-content:space-between;align-items:start;gap:1rem">
      <div>
        <div style="font-size:.6rem;letter-spacing:.2em;text-transform:uppercase;color:var(--rose2);margin-bottom:.3rem">${s.tag}</div>
        <div style="font-family:'Noto Nastaliq Urdu',serif;direction:rtl;font-size:.95rem;line-height:2;color:var(--cream)">${(s.urdu||'').split('\n')[0]}</div>
        <div style="font-size:.72rem;color:var(--dim);margin-top:.2rem">— <span style="color:var(--gold2)">${s.author||'Anonymous'}</span></div>
      </div>
      <button class="btn btn-danger btn-sm" onclick="deleteShayari('${s.id}')">Delete</button>
    </div>
  `).join('');
}

// ── ADD SHAYARI ──
function generateId(){return 's'+Date.now()+'_'+Math.random().toString(36).slice(2,6)}

async function addShayari(){
  const urdu=document.getElementById('a-urdu').value.trim();
  if(!urdu){toast('Please enter the Urdu/Hindi verse.','error');return}
  const tagSel=document.getElementById('a-tag').value;
  const tag=tagSel==='custom'?document.getElementById('a-custom-tag').value.trim()||'General':tagSel;
  const en=document.getElementById('a-en').value.trim();
  const author=document.getElementById('a-author').value.trim();
  const item={id:generateId(),tag,urdu,en,author,date:new Date().toISOString().slice(0,10)};
  shayari.push(item);
  saveData(shayari);
  refreshAll();
  clearAddForm();
  toast('✦ Verse published to your site!','success');
}

async function quickAdd(){
  const urdu=document.getElementById('q-urdu').value.trim();
  if(!urdu){toast('Please enter the verse first.','error');return}
  const tagSel=document.getElementById('q-tag').value;
  const en=document.getElementById('q-en').value.trim();
  const author=document.getElementById('q-author').value.trim();
  const item={id:generateId(),tag:tagSel,urdu,en,author,date:new Date().toISOString().slice(0,10)};
  shayari.push(item);
  saveData(shayari);
  document.getElementById('q-urdu').value='';
  document.getElementById('q-en').value='';
  document.getElementById('q-author').value='';
  refreshAll();
  toast('✦ Verse published!','success');
}

function clearAddForm(){
  ['a-urdu','a-en','a-author'].forEach(id=>document.getElementById(id).value='');
  document.getElementById('a-tag').value='Ishq · Love';
  document.getElementById('customTagField').style.display='none';
  updatePreview();
}

function handleTagChange(){
  const v=document.getElementById('a-tag').value;
  document.getElementById('customTagField').style.display=v==='custom'?'flex':'none';
  updatePreview();
}

// ── PREVIEW ──
function updatePreview(){
  const urdu=document.getElementById('a-urdu').value.trim();
  const en=document.getElementById('a-en').value.trim();
  const tagSel=document.getElementById('a-tag').value;
  const tag=tagSel==='custom'?(document.getElementById('a-custom-tag').value.trim()||'Custom'):tagSel;
  const author=document.getElementById('a-author').value.trim();
  const p=document.getElementById('livePreview');
  if(!urdu){p.innerHTML='<div class="preview-card"><div class="preview-empty">Start typing to see your verse preview...</div></div>';return}
  p.innerHTML=`
    <div class="preview-card">
      <p style="font-size:.62rem;letter-spacing:.28em;text-transform:uppercase;color:var(--rose2);margin-bottom:1rem">${tag}</p>
      <p style="font-family:'Noto Nastaliq Urdu',serif;direction:rtl;font-size:1rem;line-height:2.2;color:var(--cream);margin-bottom:.8rem">${urdu.replace(/\n/g,'<br>')}</p>
      ${en?`<p style="font-style:italic;font-size:.9rem;line-height:1.8;color:var(--fog);padding-left:.8rem;border-left:1px solid rgba(212,168,83,.2);margin-bottom:1rem">${en.replace(/\n/g,'<br>')}</p>`:''}
      <p style="font-size:.72rem;color:var(--dim)">— <span style="color:var(--gold2)">${author||'Anonymous'}</span></p>
    </div>`;
}

// ── MANAGE ──
function renderManageList(){
  const q=(document.getElementById('searchInput').value||'').toLowerCase();
  const ft=document.getElementById('filterTag').value;
  const tags=['All Genres',...new Set(shayari.map(s=>s.tag))];
  const sel=document.getElementById('filterTag');
  const cur=sel.value;
  sel.innerHTML=tags.map(t=>`<option value="${t==='All Genres'?'':t}"${cur===t?'selected':''}>${t}</option>`).join('');

  let filtered=[...shayari].reverse();
  if(ft)filtered=filtered.filter(s=>s.tag===ft);
  if(q)filtered=filtered.filter(s=>(s.urdu||'').includes(q)||(s.en||'').toLowerCase().includes(q)||(s.author||'').toLowerCase().includes(q)||(s.tag||'').toLowerCase().includes(q));

  const list=document.getElementById('manageList');
  if(!filtered.length){list.innerHTML='<p style="color:var(--dim);font-style:italic;padding:2rem;text-align:center">No verses match your search.</p>';return}
  list.innerHTML=filtered.map(s=>`
    <div class="slist-item">
      <div>
        <div class="slist-tag">${s.tag}</div>
        <div class="slist-urdu">${(s.urdu||'').replace(/\n/g,'<br>')}</div>
        ${s.en?`<div class="slist-en">${s.en.replace(/\n/g,'<br>')}</div>`:''}
        <div class="slist-meta">By <span>${s.author||'Anonymous'}</span> · ${s.date||''}</div>
      </div>
      <div class="slist-actions">
        <button class="btn btn-secondary btn-sm" onclick="openEdit('${s.id}')">Edit</button>
        <button class="btn btn-danger btn-sm" onclick="deleteShayari('${s.id}')">Delete</button>
      </div>
    </div>
  `).join('');
}

// ── EDIT ──
function openEdit(id){
  const s=shayari.find(x=>x.id===id);if(!s)return;
  editId=id;
  document.getElementById('e-urdu').value=s.urdu||'';
  document.getElementById('e-en').value=s.en||'';
  document.getElementById('e-author').value=s.author||'';
  const sel=document.getElementById('e-tag');
  // add option if not in list
  const existing=Array.from(sel.options).find(o=>o.value===s.tag);
  if(!existing){const o=document.createElement('option');o.value=s.tag;o.textContent=s.tag;sel.appendChild(o)}
  sel.value=s.tag;
  document.getElementById('editModal').style.display='flex';
}
function closeEdit(){document.getElementById('editModal').style.display='none';editId=null}
async function saveEdit(){
  if(!editId)return;
  const idx=shayari.findIndex(x=>x.id===editId);if(idx<0)return;
  shayari[idx]={...shayari[idx],
    urdu:document.getElementById('e-urdu').value.trim(),
    en:document.getElementById('e-en').value.trim(),
    tag:document.getElementById('e-tag').value,
    author:document.getElementById('e-author').value.trim(),
  };
  saveData(shayari);
  refreshAll();closeEdit();
  toast('Verse updated successfully.','success');
}

// ── DELETE ──
async function deleteShayari(id){
  if(!confirm('Delete this verse permanently?'))return;
  shayari=shayari.filter(s=>s.id!==id);
  saveData(shayari);refreshAll();
  toast('Verse deleted.','error');
}
async function deleteAll(){
  if(!confirm('Delete ALL verses permanently? This cannot be undone.'))return;
  shayari=[];saveData(shayari);refreshAll();
  toast('All verses deleted.','error');
}
async function resetToDefaults(){
  if(!confirm('This will replace all verses with the default sample collection. Continue?'))return;
  shayari=[...DEFAULT_SHAYARI];saveData(shayari);refreshAll();
  toast('Restored to default collection.','success');
}

// ── EXPORT / IMPORT ──
function exportShayari(){
  const blob=new Blob([JSON.stringify(shayari,null,2)],{type:'application/json'});
  const a=document.createElement('a');a.href=URL.createObjectURL(blob);
  a.download='humsafar-shayari-'+new Date().toISOString().slice(0,10)+'.json';a.click();
  toast('Collection exported.','success');
}
function importShayari(e){
  const file=e.target.files[0];if(!file)return;
  const reader=new FileReader();
  reader.onload=ev=>{
    try{
      const data=JSON.parse(ev.target.result);
      if(!Array.isArray(data))throw new Error();
      if(!confirm(`Import ${data.length} verses? This will add to your current collection.`))return;
      shayari=[...shayari,...data.map(s=>({...s,id:generateId()}))];
      saveData(shayari);refreshAll();
      toast(`${data.length} verses imported.`,'success');
    }catch{toast('Invalid JSON file.','error')}
  };reader.readAsText(file);
}

// ── PASSWORD ──
function changePassword(){
  const np=document.getElementById('newPwd').value;
  const cp=document.getElementById('confirmPwd').value;
  if(!np){toast('Enter a new password.','error');return}
  if(np!==cp){toast('Passwords do not match.','error');return}
  if(np.length<6){toast('Password must be at least 6 characters.','error');return}
  savePwd(np);
  document.getElementById('newPwd').value='';document.getElementById('confirmPwd').value='';
  toast('Password updated successfully.','success');
}

// ── SETTINGS SAVE ──
function saveSiteSettings(){toast('Settings saved.','success')}

// ── TOAST ──
function toast(msg,type='success'){
  const t=document.getElementById('toast');
  const d=document.createElement('div');
  d.className=`toast-msg ${type}`;d.textContent=msg;
  t.appendChild(d);
  setTimeout(()=>{d.style.opacity='0';d.style.transform='translateX(30px)';d.style.transition='.4s';setTimeout(()=>d.remove(),400)},3000);
}

// ── KEYBOARD ──
document.addEventListener('keydown',e=>{
  if(e.key==='Escape')closeEdit();
});
</script>
</body>
</html>
